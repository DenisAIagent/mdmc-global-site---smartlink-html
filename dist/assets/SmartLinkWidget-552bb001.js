import{e as L,c as e,v as y,T as l,d as r,S as o,L as w,g as S,J as z,B as h,aX as A,aY as T,n as k,a1 as D,al as V,l as j,U as B,bn as E,a5 as I,I as C,O as P,X as R,bD as W,ax as v,bE as O,a7 as N,b5 as X,r as d}from"./ui-8fe63d91.js";import{r as M}from"./vendor-73f70a13.js";import{V as H}from"./index-afbc5cb2.js";import"./router-d3a551c4.js";import"./i18n-757038dc.js";import"./utils-b8a29b2a.js";import"./analytics-f0f53c8f.js";import"./forms-769d622f.js";const U=({smartLink:i,index:s,showRank:p=!0,showActions:g=!0})=>{const c=L(),[m,u]=M.useState(null),x=a=>{a.preventDefault(),u(a.currentTarget)},b=()=>{u(null)},n=a=>{console.log(`Action ${a} sur SmartLink:`,i.id),b()},f=1500,t=Math.min(i.clicks/f*100,100);return r(T,{sx:{bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:1,mb:1,transition:"all 0.2s ease","&:hover":{bgcolor:"action.hover",transform:"translateX(4px)",boxShadow:2}},children:[r(o,{direction:"row",alignItems:"center",spacing:2,sx:{mr:2},children:[p&&r(k,{sx:{width:32,height:32,bgcolor:s<3?c.palette.primary.main:c.palette.grey[400],fontSize:"0.875rem",fontWeight:"bold"},children:["#",s+1]}),e(k,{sx:{bgcolor:c.palette.secondary.main},children:e(D,{})})]}),e(V,{primary:r(o,{direction:"row",alignItems:"center",spacing:1,flexWrap:"wrap",children:[e(l,{variant:"subtitle2",sx:{fontWeight:600},children:i.title}),e(j,{label:i.artist,size:"small",variant:"outlined",color:"primary"})]}),secondary:r(h,{sx:{mt:1},children:[r(o,{direction:"row",alignItems:"center",spacing:2,sx:{mb:1},children:[r(l,{variant:"body2",color:"text.secondary",children:[i.clicks.toLocaleString()," clics"]}),r(l,{variant:"body2",color:"success.main",children:["+",Math.floor(Math.random()*50+10),"% cette semaine"]})]}),e(B,{variant:"determinate",value:t,sx:{height:4,borderRadius:2,bgcolor:"grey.200","& .MuiLinearProgress-bar":{borderRadius:2,bgcolor:s<3?c.palette.primary.main:c.palette.secondary.main}}})]})}),g&&r(E,{children:[r(o,{direction:"row",spacing:1,children:[e(I,{title:"Voir les analytics",children:e(C,{size:"small",onClick:()=>n("analytics"),children:e(P,{fontSize:"small"})})}),e(I,{title:"Plus d'options",children:e(C,{size:"small",onClick:x,children:e(R,{fontSize:"small"})})})]}),r(W,{anchorEl:m,open:!!m,onClose:b,children:[r(v,{onClick:()=>n("open"),children:[e(O,{fontSize:"small",sx:{mr:1}}),"Ouvrir le lien"]}),r(v,{onClick:()=>n("edit"),children:[e(N,{fontSize:"small",sx:{mr:1}}),"Modifier"]}),r(v,{onClick:()=>n("share"),children:[e(X,{fontSize:"small",sx:{mr:1}}),"Partager"]})]})]})]})},Y=({count:i=5})=>e(o,{spacing:1,children:Array.from({length:i}).map((s,p)=>e(h,{sx:{p:2,border:1,borderColor:"divider",borderRadius:1},children:r(o,{direction:"row",spacing:2,alignItems:"center",children:[e(d,{variant:"circular",width:32,height:32}),e(d,{variant:"circular",width:40,height:40}),r(h,{sx:{flex:1},children:[e(d,{variant:"text",width:"70%",height:24}),e(d,{variant:"text",width:"40%",height:20}),e(d,{variant:"rectangular",width:"100%",height:4,sx:{mt:1}})]}),e(d,{variant:"circular",width:24,height:24})]})},p))}),Z=({variant:i="top",limit:s=10,widgetId:p,isEditing:g=!1,title:c="Top SmartLinks"})=>{L();const{data:m,isLoading:u,error:x}=H();M.useState("list");const n=(()=>{if(!m)return[];const{topSmartLinks:t}=m;return i==="recent"?(t==null?void 0:t.slice(0,s).map(a=>({...a,createdAt:new Date(Date.now()-Math.random()*7*24*60*60*1e3)})))||[]:(t==null?void 0:t.slice(0,s))||[]})(),f=()=>{console.log("Navigation vers liste complète SmartLinks")};return x?e(y,{sx:{p:2,height:"100%",minHeight:250},children:e(l,{color:"error",variant:"body2",children:"Erreur de chargement des SmartLinks"})}):r(y,{sx:{p:2,height:"100%",minHeight:250,display:"flex",flexDirection:"column",...g&&{cursor:"move","&:hover":{bgcolor:"action.hover"}}},children:[r(o,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[r(o,{direction:"row",alignItems:"center",spacing:1,children:[e(w,{color:"primary"}),e(l,{variant:"h6",sx:{fontWeight:600},children:c})]}),e(S,{size:"small",endIcon:e(z,{}),onClick:f,children:"Voir tout"})]}),e(h,{sx:{flex:1,overflowY:"auto"},children:u?e(Y,{count:Math.min(s,5)}):n.length===0?r(h,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:150,color:"text.secondary"},children:[e(w,{sx:{fontSize:48,mb:1,opacity:.5}}),e(l,{variant:"body2",children:"Aucun SmartLink disponible"}),e(S,{size:"small",sx:{mt:1},children:"Créer le premier SmartLink"})]}):e(A,{sx:{p:0},children:n.map((t,a)=>e(U,{smartLink:t,index:a,showRank:i==="top",showActions:!g},t.id))})}),n.length>0&&e(h,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:r(o,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[r(l,{variant:"caption",color:"text.secondary",children:[n.length," SmartLinks affichés"]}),r(l,{variant:"caption",color:"text.secondary",children:["Total clics: ",n.reduce((t,a)=>t+a.clicks,0).toLocaleString()]})]})}),!1]})};export{Z as default};
//# sourceMappingURL=SmartLinkWidget-552bb001.js.map
